اگر Gazebo باز نمی‌شود، معمولاً یکی از چند مشکل رایج رخ داده: نصب ناقص، نسخه ناسازگار، یا مشکل محیط گرافیکی. چون Ubuntu 22.04 داری و هدف PX4 SITL هست، مراحل زیر را چک کن:

---

## ۱️⃣ بررسی نصب Gazebo

```bash
gazebo --version
```

* باید چیزی مثل `Gazebo 11` نمایش داده شود.
* اگر خطا آمد، نصب ناقص است. دوباره نصب کن:

```bash
sudo apt update
sudo apt install gazebo11 libgazebo11-dev -y
sudo apt install ros-humble-gazebo-ros-pkgs -y
```

> PX4 روی Ubuntu 22.04 با **Gazebo 11 (Classic)** بهترین سازگاری را دارد.

---

## ۲️⃣ تست Gazebo به صورت standalone

```bash
gazebo
```

* باید پنجره باز شود و یک world خالی ببینی.
* اگر باز نشد و خطای OpenGL یا نمایشگر دارد، مطمئن شو که **در محیط دسکتاپ هستی** (نه SSH بدون X11) یا از `vnc`/`xserver` استفاده کن.

---

## ۳️⃣ تنظیم PX4 برای Gazebo Classic

در پوشه PX4-Autopilot:

```bash
cd ~/PX4-Autopilot
make clean
make px4_sitl gazebo
```

> اگر باز هم پنجره Gazebo نیامد، سعی کن explicit Gazebo path بدهی:

```bash
export GAZEBO_MODEL_PATH=~/PX4-Autopilot/Tools/sitl_gazebo/models
export GAZEBO_RESOURCE_PATH=/usr/share/gazebo-11
gazebo
```

---

## ۴️⃣ مشکلات گرافیکی رایج

* اگر داخل **VM یا SSH بدون X11** هستی، Gazebo باز نمی‌شود. باید از:

  * اتصال مستقیم به محیط گرافیکی
  * یا X11 forwarding: `ssh -X user@host`
  * یا VNC / Remote Desktop

* بررسی کارت گرافیک: `glxinfo | grep OpenGL`

---

## ۵️⃣ راهنمای نهایی PX4 SITL با Gazebo

برای اجرای چند پهپاد:

```bash
cd ~/PX4-Autopilot
./Tools/simulation/gazebo-classic/sitl_multiple_run.sh -n 4
```

> اگر Gazebo باز نشد، احتمالاً مربوط به نصب Gazebo یا محیط دسکتاپ است.

---

اگر بخواهی، من می‌توانم **دستورالعمل کامل و تضمینی نصب PX4 + Gazebo 11 روی Ubuntu 22.04** را مرحله به مرحله بنویسم تا مطمئن باشیم پنجره Gazebo بالا می‌آید و SITL اجرا می‌شود.

می‌خوای برات آماده کنم؟
