خب، اگر Gazebo 11 روی Ubuntu 22.04 نصب نشده، بهترین کار این است که **Gazebo Classic 11** را مستقیماً نصب کنیم و مسیرهای محیطی را درست تنظیم کنیم تا PX4 SITL بتواند اجرا شود.

این دستورالعمل را مرحله به مرحله دنبال کن:

---

## ۱️⃣ حذف نصب ناقص (اگر نصب شده)

```bash
sudo apt remove --purge gazebo* -y
sudo apt autoremove -y
```

---

## ۲️⃣ اضافه کردن repository رسمی Gazebo

```bash
sudo sh -c 'echo "deb http://packages.osrfoundation.org/gazebo/ubuntu-stable $(lsb_release -cs) main" > /etc/apt/sources.list.d/gazebo-stable.list'
wget https://packages.osrfoundation.org/gazebo.key -O - | sudo apt-key add -
sudo apt update
```

---

## ۳️⃣ نصب Gazebo Classic 11

```bash
sudo apt install gazebo11 libgazebo11-dev -y
```

* این کار نسخه 11 را نصب می‌کند که با PX4 روی Ubuntu 22.04 سازگار است.

---

## ۴️⃣ نصب بسته ROS2 مرتبط با Gazebo

```bash
sudo apt install ros-humble-gazebo-ros-pkgs -y
```

---

## ۵️⃣ تنظیم متغیرهای محیطی (برای PX4)

```bash
echo "export GAZEBO_MODEL_PATH=~/PX4-Autopilot/Tools/sitl_gazebo/models" >> ~/.bashrc
echo "export GAZEBO_RESOURCE_PATH=/usr/share/gazebo-11" >> ~/.bashrc
echo "export PX4_HOME_LAT=47.397742" >> ~/.bashrc
echo "export PX4_HOME_LON=8.545594" >> ~/.bashrc
echo "export PX4_HOME_ALT=488" >> ~/.bashrc
source ~/.bashrc
```

---

## ۶️⃣ تست نصب Gazebo

```bash
gazebo
```

* باید پنجره Gazebo باز شود و یک محیط خالی نمایش داده شود.

---

## ۷️⃣ اجرای PX4 SITL تک پهپاد

```bash
cd ~/PX4-Autopilot
make px4_sitl gazebo
```

* اگر پنجره Gazebo باز شد، PX4 SITL با Gazebo 11 آماده است.

---

اگر بخواهی، من می‌توانم یک **اسکریپت آماده نصب کامل PX4 + Gazebo 11 + ROS2 Humble روی Ubuntu 22.04** بنویسم که تمام مراحل بالا را خودکار انجام دهد و مستقیم SITL اجرا شود.

می‌خوای برات آماده کنم؟
