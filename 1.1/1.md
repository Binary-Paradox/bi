عالی ✅، حالا که تمام فایل‌ها را داری، مراحل اجرای کامل پروژه روی **Ubuntu 22.04 + ROS2 Humble + PX4 SITL + Gazebo 11** به صورت مرحله به مرحله این است:

---

## ۱️⃣ آماده‌سازی Workspace

1. فایل زیپ را دانلود و باز کن:

```bash
cd ~
unzip px4_formation_project.zip -d formation_ws/src
```

2. مسیر Workspace:

```
~/formation_ws/src/px4_formation
```

---

## ۲️⃣ نصب پیش‌نیازها (اگر قبلاً نصب نکردی)

```bash
sudo apt update
sudo apt install python3-pip python3-colcon-common-extensions ros-humble-desktop ros-humble-gazebo-ros-pkgs gazebo11 libgazebo11-dev -y
pip3 install mavsdk
```

* مطمئن شو که ROS2 Humble نصب شده باشد.
* MAVSDK پایتون نصب باشد.

---

## ۳️⃣ بیلد Workspace

```bash
cd ~/formation_ws
colcon build
source install/setup.bash
```

* اگر خطا بود، مطمئن شو `package.xml`, `setup.py` و کد پایتون درست باشند.

---

## ۴️⃣ آماده‌سازی PX4 SITL

1. اگر PX4 نصب نکرده‌ای:

```bash
cd ~
git clone https://github.com/PX4/PX4-Autopilot.git --recursive
cd PX4-Autopilot
bash ./Tools/setup/ubuntu.sh
```

2. تنظیم متغیرهای محیطی در `~/.bashrc`:

```bash
echo "export GAZEBO_MODEL_PATH=~/PX4-Autopilot/Tools/sitl_gazebo/models" >> ~/.bashrc
echo "export GAZEBO_RESOURCE_PATH=/usr/share/gazebo-11" >> ~/.bashrc
echo "export PX4_HOME_LAT=47.397742" >> ~/.bashrc
echo "export PX4_HOME_LON=8.545594" >> ~/.bashrc
echo "export PX4_HOME_ALT=488" >> ~/.bashrc
source ~/.bashrc
```

---

## ۵️⃣ اجرای پروژه با لانچ فایل

```bash
cd ~/formation_ws
source install/setup.bash
ros2 launch px4_formation formation_launch.py
```

* پنجره Gazebo باز می‌شود و ۴ پهپاد بالا می‌آیند.
* نود Formation به طور خودکار اجرا می‌شود:

  * پهپادها آرم و تیک‌آف می‌کنند
  * لیدر حرکت می‌کند و فالورها پشت سرش خط می‌گیرند
  * در پایان همه لند می‌کنند

---

## ✅ نکات مهم

* اگر Gazebo باز نشد، مطمئن شو **Ubuntu دسکتاپ** داری و از VM با شتاب GPU استفاده می‌کنی.
* اگر چند پهپاد خیلی کند اجرا شدند، می‌توانی سرعت شبیه‌سازی را کم کنی یا منابع بیشتری اختصاص دهی.
* بعد از اطمینان از کارکرد پایه، می‌توانیم **کنترل Formation دقیق‌تر یا اجتناب از مانع** اضافه کنیم.

---

اگر بخواهی، می‌توانم یک **دستورالعمل و اسکریپت آماده** بسازم که با یک دستور تمام پروژه (Gazebo + PX4 + Formation) ران شود بدون اینکه نیاز به اجرای جداگانه باشد.

می‌خوای این کار را هم انجام دهم؟
